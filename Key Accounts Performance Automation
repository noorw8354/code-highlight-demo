SET odps.sql.type.system.odps2 = true
;

SELECT  cc.*
,dd.ka_type
,dd.ka_manager
FROM    (
SELECT  COALESCE(cm.l1,ly.l1) AS l1
,COALESCE(cm.l2,ly.l2) AS l2
,COALESCE(cm.l3,ly.l3) AS l3
,COALESCE(cm.l4,ly.l4) AS l4
,COALESCE(cm.business_area,ly.business_area) AS business_area
,COALESCE(cm.join_id,ly.join_id) AS join_id
,COALESCE(cm.seller_id,ly.seller_id) AS seller_id
,COALESCE(cm.shop_account_code,ly.shop_account_code) AS shop_account_code
,COALESCE(cm.shop_account_name,ly.shop_account_name) AS shop_account_name
,cm.gmv_usd
,cm.gmv_pkr
,cm.orders
,cm.buyers
,cm.items
,cm.nmv_usd
,ly.gmv_usd AS ly_gmv_usd
,ly.gmv_pkr AS ly_gmv_pkr
,ly.orders AS ly_orders
,ly.buyers AS ly_buyers
,ly.nmv_usd AS ly_nmv_usd
,ly.items AS ly_items
FROM    (
SELECT  CASE    WHEN venture_category1_name_en IN ('SOF','Cameras','Computers & Laptops','Home Appliances','Mobiles & Tablets','TV, Audio / Video, Gaming & Wearables','TV Audio Video Gaming & Wearables','TV Audio Video Gaming & Wearables') THEN 'Electronics'
WHEN venture_category1_name_en IN ('Bags and Travel','Fashion','Watches Sunglasses Jewellery') THEN 'Fashion'
WHEN venture_category1_name_en IN ('Bedding & Bath','Toys Kids & Babies','Charity and Donation','Furniture & Décor','Furniture & DÃ©cor','Furniture & Decor','Furniture & D√©cor','Home & Living','Kitchen & Dining','Laundry & Cleaning','Media, Music & Books','Media Music & Books','Motors','Sports & Outdoors','Stationery & Craft','Tools, DIY & Outdoor','Tools DIY & Outdoor','Toys & Games','Wholesale','Packaging Material',"Special Promotion") THEN 'Lifestyle'
WHEN venture_category1_name_en IN ('Groceries','Health & Beauty','Mother & Baby','Pet Supplies','Medicine','Livestock','Sample') THEN 'FMCG'
WHEN venture_category1_name_en IN ('Digital Goods','Topup','Service Product','Special Digital Products') THEN 'Digital Goods'
ELSE 'Unidentified'
END AS industry
,venture_category1_name_en AS l1
,COALESCE(venture_category2_name_en,venture_category1_name_en) AS l2
,COALESCE(venture_category3_name_en,venture_category2_name_en,venture_category1_name_en) AS l3
,COALESCE(venture_category4_name_en,venture_category3_name_en,venture_category2_name_en,venture_category1_name_en) AS l4
,business_area
,IF(seller_id = 1000000,brand_id,seller_id) AS join_id
,seller_id
,shop_account_code
,shop_account_name
,COUNT(DISTINCT sales_order_id) AS orders
,COUNT(DISTINCT sales_order_item_id) AS items
,COUNT(DISTINCT buyer_id) AS buyers
,SUM(actual_gmv * exchange_rate) AS gmv_usd
,SUM(actual_gmv) AS gmv_pkr
,SUM(actual_gmv * net_item * exchange_rate) AS nmv_usd
FROM    daraz_cdm.dwd_drz_trd_core_df
WHERE   ds = MAX_PT('daraz_cdm.dwd_drz_trd_core_df') --AND     TO_CHAR(fulfillment_create_date,"yyyymm") IN (202304,202404)
AND     TO_DATE(fulfillment_create_date) >= DATETRUNC(TO_DATE(now()),'mm')
AND     TO_DATE(fulfillment_create_date) < TO_DATE(now())
AND     (
shop_account_code NOT IN ('PK2NBODB253','PK2NBR1VOAS')
AND     brand_id NOT IN ('127088430')
)
AND     venture IN ('PK')
AND     unit_price > 1
AND     venture_category1_name_en IN ('Bags and Travel','Fashion','Watches Sunglasses Jewellery','Furniture & Décor','Furniture & DÃ©cor','Furniture & Decor','Furniture & D√©cor','Bedding & Bath','Furniture & Décor','Kitchen & Dining','Laundry & Cleaning','Media, Music & Books','Motors','Sports & Outdoors','Stationery & Craft','Tools, DIY & Outdoor','Toys & Games','Packaging Material','Charity and Donation') --AND     venture_category1_name_en IN ('Sports & Outdoors','Stationery & Craft','Toys & Games','Media, Music & Books','Bags and Travel','Fashion','Watches Sunglasses Jewellery')
AND     is_fulfilled = '1'
GROUP BY industry
,l1
,l2
,l3
,l4
,business_area
,seller_id
,shop_account_code
,shop_account_name
,join_id
) AS cm
FULL OUTER JOIN (
SELECT  CASE    WHEN venture_category1_name_en IN ('SOF','Cameras','Computers & Laptops','Home Appliances','Mobiles & Tablets','TV, Audio / Video, Gaming & Wearables','TV Audio Video Gaming & Wearables','TV Audio Video Gaming & Wearables') THEN 'Electronics'
WHEN venture_category1_name_en IN ('Bags and Travel','Fashion','Watches Sunglasses Jewellery') THEN 'Fashion'
WHEN venture_category1_name_en IN ('Bedding & Bath','Toys Kids & Babies','Charity and Donation','Furniture & Décor','Furniture & DÃ©cor','Furniture & Decor','Furniture & D√©cor','Home & Living','Kitchen & Dining','Laundry & Cleaning','Media, Music & Books','Media Music & Books','Motors','Sports & Outdoors','Stationery & Craft','Tools, DIY & Outdoor','Tools DIY & Outdoor','Toys & Games','Wholesale','Packaging Material',"Special Promotion") THEN 'Lifestyle'
WHEN venture_category1_name_en IN ('Groceries','Health & Beauty','Mother & Baby','Pet Supplies','Medicine','Livestock','Sample') THEN 'FMCG'
WHEN venture_category1_name_en IN ('Digital Goods','Topup','Service Product','Special Digital Products') THEN 'Digital Goods'
ELSE 'Unidentified'
END AS industry
,venture_category1_name_en AS l1
,COALESCE(venture_category2_name_en,venture_category1_name_en) AS l2
,COALESCE(venture_category3_name_en,venture_category2_name_en,venture_category1_name_en) AS l3
,COALESCE(venture_category4_name_en,venture_category3_name_en,venture_category2_name_en,venture_category1_name_en) AS l4
,business_area
,IF(seller_id = 1000000,brand_id,seller_id) AS join_id
,seller_id
,shop_account_code
,shop_account_name
,COUNT(DISTINCT sales_order_id) AS orders
,COUNT(DISTINCT sales_order_item_id) AS items
,COUNT(DISTINCT buyer_id) AS buyers
,SUM(actual_gmv * exchange_rate) AS gmv_usd
,SUM(actual_gmv) AS gmv_pkr
,SUM(actual_gmv * net_item * exchange_rate) AS nmv_usd
FROM    daraz_cdm.dwd_drz_trd_core_df
WHERE   ds = MAX_PT('daraz_cdm.dwd_drz_trd_core_df') --AND     TO_CHAR(fulfillment_create_date,"yyyymm") IN (202304,202404)
AND     TO_DATE(fulfillment_create_date) >= DATETRUNC(TO_DATE(now()),'mm') - INTERVAL 1 YEAR
AND     TO_DATE(fulfillment_create_date) < TO_DATE(now()) - INTERVAL 1 YEAR
AND     (
shop_account_code NOT IN ('PK2NBODB253','PK2NBR1VOAS')
AND     brand_id NOT IN ('127088430')
)
AND     venture IN ('PK')
AND     unit_price > 1
AND     venture_category1_name_en IN ('Bags and Travel','Fashion','Watches Sunglasses Jewellery','Furniture & Décor','Furniture & DÃ©cor','Furniture & Decor','Furniture & D√©cor','Bedding & Bath','Furniture & Décor','Kitchen & Dining','Laundry & Cleaning','Media, Music & Books','Motors','Sports & Outdoors','Stationery & Craft','Tools, DIY & Outdoor','Toys & Games','Packaging Material','Charity and Donation') --AND     venture_category1_name_en IN ('Sports & Outdoors','Stationery & Craft','Toys & Games','Media, Music & Books','Bags and Travel','Fashion','Watches Sunglasses Jewellery')
AND     is_fulfilled = '1'
GROUP BY industry
,l1
,l2
,l3
,l4
,business_area
,seller_id
,shop_account_code
,shop_account_name
,join_id
) AS ly
ON      cm.industry = ly.industry
AND     cm.l1 = ly.l1
AND     cm.l2 = ly.l2
AND     cm.l3 = ly.l3
AND     cm.l4 = ly.l4
AND     cm.business_area = ly.business_area
AND     cm.join_id = ly.join_id
) AS cc
LEFT JOIN   (
SELECT  DISTINCT venture
,seller_id
,short_code
,brand_id
,main_category
,IF(seller_id = 1000000,brand_id,seller_id) AS join_id
,key_account_type AS ka_type
,CASE   WHEN short_code IN ('PK2NBNMTSRM','PK105VH','PK2NBNU32WW','PK2NBNLBDJE','PK1PML5','PK2NBNK8YKI','PK2NBNK001K','PK104AV','PK10FOS','PK10313','PK10FPX','PK10L4Y','PK1NYS3','PK10KKO','PK2NBNJEM5U','PK1RA5L','PK2NBNN6BV1','PK1083M','PK100X8','PK109GE','PK1RPFO','PK2NBNJEETF','PK2NBNJY3Y8','PK10KS6','PK1NIO7','PK10NCP','PK10FKM','PK2NBNKCR3X','PK2NBNJT54I','PK1P8YU','PK2NBOAVK33','PK2NBNKOJJ1','PK2NBNJZSVU','PK10NLF','PK1RRRO','PK103CS','PK107UZ','PK2NBNU02LL','PK1PNVF','PK108SY','PK2NBNNURL8','PK2NBNKUVOO','PK10D4M','PK2NBNJZK7T','PK2NBNLRHG3','PK2NBNU4HIR','PK105VC','PK2NBNLX8AS','PK1P1M4','PK1032G','PK2NBNL987L','PK2NBOK1195','PK1O2RH','PK2NBNJ3CXL','PK100XS','PK1NSND','PK2NBNLB8UB','PK1NVDU','PK2NBOPZZ4A','PK1076I','PK2NBNS52NI','PK2NBNJZFVE','PK2NBNVG7U7','PK2NBNKFVT1','PK2NBNJ2B4T','PK10GOZ','PK10MYR','PK10KWY','PK10588','PK2NBNHHL18','PK2NBNL9V2T','PK1PGMB','PK1NMKI','PK1OOI6','PK2NBO2T862','PK1NE3T','PK2NBNKOUDY','PK2NBOD1ES1','PK1O0G8','PK2NBNLOBOS','PK1NTFI','PK1OVCC','PK2NBNL2CTN','PK2NBOCC7KC','PK2NBNMX0I9','PK2NBOVSGU9','PK2NBNPPTM9','PK2NBNR745K','PK1PHGD','PK1P92Y','PK2NBNLONYF','PK2NBNL74VT','PK104IZ','PK2NBNKR602','PK2NBNKKHY6','PK2NBNJOHHG','PK1OVD8','PK2NBNK8NLK','PK1P8OF','PK2NBNLDZ7D','PK109OH','PK100YY','PK1OZMJ','PK2NBNRO4FL','PK2NBNI84Y9','PK2NBNTJM4G','PK1OU6Z','PK2NBNKHH5K','PK2NBNLA26G','PK2NBNKKP1U','PK1NI85','PK2NBNY56WK','PK2NBNSJRSS','PK1065T','PK2NBNK1W2U','PK2NBNONTA1','PK2NBO43MY2','PK2NBNXXFGW','PK1PWT0','PK1NY39','PK2NBNNBHWP','PK1R9JV','PK2NBO5G0PA','PK2NBNN6DTB','PK2NBNMM56R','PK2NBNWAJ4W','PK2NBNK4WIK','PK2NBO8DBDR','PK2NBNITA8J','PK2NBO3Z0XW','PK2NBO5WWB6','PK10HD4','PK10233','PK10L0D','PK1ORWL','PK2NBNK1NTC','PK2NBOFCY18','PK2NBNN781F','PK2NBNJTWZP','PK2NBNWAC2W','PK106A0','PK2NBNMRLYB','PK1NZY5','PK1O6S9','PK2NBNK8DRY','PK2NBNKDOZF','PK2NBNKLYXM','PK2NBNO7HTH','PK2NBNINTRE','PK10H5K','PK1OC23','PK1PNE1','PK2NBNL9MWI','PK10J0L','PK2NBOVESN5','PK2NBNKKMFO','PK107ZT','PK1RJYY','PK2NBOLJEMA','PK2NBNIE7Z1','PK2NBO9AK5F','PK2NBNINRB8','PK2NBNHIXJE','PK2NBNK2XWA','PK2NBO67IMF','PK2NBNKCG08','PK2NBNKDSHE','PK2NBO27KUL','PK2NBNK88TY','PK2NBNIO5VI','PK2NBOA237A','PK2NBOCA8BL','PK2NBNJZKL5','PK2NBNLCY3J','PK2NBNMRJRH','PK2NBNIZATU','PK2NBNMJOE2','PK2NBOHRJDU','PK2NBO6Z1PA','PK2NBOCTMTB','PK1NRFC','PK2NBNL7R73','PK2NBOBD9TL','PK2NBNU02VW','PK2NBNY4CKB','PK2NBNLUFOP','PK1RSW0','PK2NBNKSX4V','PK1A932','PK2NBO0SM6Y','PK2NBNJUW15','PK1O080','PK2NBNHW8L3','PK10DON','PK2NBNK79L8','PK10LB8','PK2NBNJK5O1','PK2NBNTLSZL','PK2NBNLWYH6','PK2NBNK25Y6','PK2NBNKTBNT','PK1NW3H','PK105YB','PK2NBO0YXB5','PK2NBNJXGWY','PK2NBNKO2BA','PK2NBO5YSBC','PK2NBNL1VK7','PK2NBNINBKE','PK2NBNPF937','PK10EKV','PK1OWL0','PK2NBNNXMOY','PK10NUK','PK2NBOCGO0T','PK2NBPYTYVM','PK2NBOCH0WX','PK2NBNMSBIG','PK2NBP7IOVV','PK2NBNK9XVT','PK2NBNI1HCI','PK2NBODTCNM','PK2NBRDXSAM','PK2NBR3RDD1','PK1O9PO','PK2NBNK9PGY','PK105RE','PK2NBO5TYBM','PK1PMXS','PK1NJ3S','PK2NBNSTVRU','PK1PR8L','PK2NBNKI91E','PK2NBNI571Y','PK2NBNIX2HL','PK1R42A','PK1P13P','PK2NBO3N1VY','PK2NBO9VML0','PK2NBNLCXIM','PK2NBNLBIDA','PK2NBNIEFB3') THEN 'KA'
WHEN short_code IN ('PK2NBO1ENGI','PK2NBNKSX7H','PK2NBO87OUO','PK2NBNK74RA','PK10EHF','PK2NBNK9SWL','PK2NBNL9CK5','PK1OOTR','PK2NBNKYXMJ','PK2NBNLNM1J','PK2NBNKKOUM','PK2NBNPI6HI','PK2NBNK2FHW','PK2NBNL3057','PK2NBOFE1XL','PK2NBNMLPNS','PK2NBOAUSZP','PK1PWB2','PK100L8','PK1OFZL','PK2NBNKP6SZ','PK2NBNLWTNE','PK10MV0','PK2NBNMJJL8','PK2NBNJ1LN7','PK1P0T6','PK1039Y','PK10E20','PK10J3J','PK10HT2','PK104FH','PK2NBNK7RMR','PK2NBNIHMZ8','PK2NBNJZN2A','PK1PN0C','PK2NBNO6R0R','PK1P2C3','PK2NBO0LTMO','PK2NBNK5PX5','PK2NBNMED9C','PK2NBNINYFO','PK2NBNUDKKX','PK2NBNKOWUH','PK1NCTV','PK2NBNH92BN','PK2NBNRSUAH','PK2NBNPNPGM','PK1PUIV','PK2NBNLDGYO','PK2NBNI26SC','PK102G2','PK2NBNMW4BM','PK2NBNKO2Y8','PK106GK','PK2NBNL2P76','PK2NBO1TTHN','PK1PM95','PK2NBNKMPRT','PK2NBNZ7F7V','PK2NBOMJTON','PK2NBNL6OEA','PK2NBNKO9V9','PK2NBNO3PKM','PK2NBNUIBXV','PK2NBOA1VU4','PK1PP5O','PK1O7AN','PK10I0O','PK2NBNHAW23','PK2NBNJNDEH','PK2NBNLAJDH','PK2NBNK1W06','PK1RKXM','PK2NBNKZJVH','PK2NBOB3C0F','PK2NBNNF9YO','PK1NFPP','PK2NBNLGHB8','PK10CXS','PK2NBO456D8','PK1PI7H','PK1066Z','PK2NBNZDI4J','PK1RUU0','PK2NBNKIGMF','PK10IKX','PK2NBNKKUUM','PK1PKSU','PK2NBNK2PCX','PK10E8D','PK2NBNH9ZBI','PK2NBNKNXIY','PK2NBNPMYD0','PK2NBNL7LXF','PK2NBNJJ6C8','PK2NBNJ3XJO','PK2NBNKYD59','PK2NBOC1WWR','PK2NBNLIKSN','PK2NBOJY0KZ','PK10G28','PK2NBNKE26E','PK1O6FR','PK2NBNRZGS9','PK2NBNL9MVO','PK109M4','PK2NBNKORSE','PK2NBNL92VL','PK2NBNKOLWN','PK2NBNK304M','PK2NBOOL0TY','PK102H1','PK1OZ3S','PK10MB7','PK2NBNLNORE','PK2NBNME5XM','PK2NBNXJ0FD','PK1NIRU','PK1PM8Y','PK2NBO04BF6','PK2NBNOEP1A','PK10C71','PK2NBNL0E2T','PK2NBOCCM02','PK2NBO4PEDI','PK2NBNIHSWP','PK2NBNZ5NKF','PK2NBNKCKOF','PK1ROCS','PK2NBNUO2PC','PK10HLU','PK2NBO1B917','PK2NBNMHL11','PK2NBNTNL8R','PK2NBNL6C5Z','PK2NBNUNVI4','PK1R3GT','PK2NBNUO2MT','PK2NBOF5V2G','PK2NBNTAL77','PK1NLS4','PK2NBNHGU6T','PK2NBNU32XH','PK10HFU','PK2NBNJM6M7','PK1NBF8','PK10MZ2','PK2NBNJ4S0S','PK2NBNV9UZR','PK2NBNWIFTJ','PK2NBNL985E','PK1ROW2','PK1015B','PK2NBNKVAOE','PK1PZW8','PK2NBNLDM0U','PK2NBNM6NVS','PK2NBO5HZKC','PK2NBOCIOSV','PK2NBNK81RX','PK2NBO7GODR','PK2NBOC3YJF','PK2NBOBH9DR','PK102VS','PK2NBOD2LAU','PK2NBNMTMYM','PK1NF1W','PK2NBNIL7WB','PK2NBNINNNU','PK2NBNSPP6W','PK2NBNSZYBS','PK2NBNKMPTW','PK2NBNKR17R','PK1OY71','PK10EEC','PK1OC4Y','PK2NBO30FIO','PK2NBNZWCRS','PK2NBNLUVDS','PK2NBNLUFF7','PK2NBNL8N01','PK2NBNL7LGL','PK2NBO891NL','PK2NBNMJJI9','PK1NEEG','PK105EO','PK2NBO3S5Z0','PK2NBOTA5PF','PK1OPTL','PK2NBNKSHCT','PK2NBO2SW0G','PK2NBNMOY5U','PK2NBOBFI1S','PK2NBNP5GH1','PK2NBNPTO08','PK2NBNS5K6K','PK2NBNLBR2E','PK2NBOCRRYN','PK2NBO3852X','PK1R4DX','PK2NBNMP5MS','PK2NBNVHEJZ','PK2NBNZ2LDR','PK2NBNK6OX7','PK2NBNHAYFG','PK1PS2I','PK2NBNRH4LK','PK2NBNMLAXB','PK2NBNKZZYM','PK2NBNMONCS','PK2NBNV3X6R','PK2NBNIMRYA','PK2NBO1IHZ5','PK1PUSF','PK1OPF8','PK2NBOTSBL5','PK2NBNK6K30','PK1PILK','PK2NBNTMEKF','PK10J90','PK2NBNL7DX4','PK2NBNK5DIT','PK2NBOEG8D8','PK1RT92','PK10L7F','PK1PI5H','PK1PN5G','PK1OYKM','PK2NBNUH5H3','PK2NBNKJ8EN','PK2NBO6W64O','PK2NBNKY66S','PK1OGRO','PK2NBNLA07K','PK2NBNOOXSO','PK2NBO5SHL3','PK2NBO46V6Y','PK2NBO81JWD','PK1PB4D','PK2NBO5TYDA','PK2NBNKZHFK','PK2NBNI2WA4','PK2NBNRN2X8','PK2NBO8HFP1','PK2NBNT6W35','PK2NBNL1TIZ','PK1PUU0','PK2NBNOL9RJ','PK2NBNMP81Y','PK2NBOD82H2','PK1P9WI','PK2NBNYOV87','PK2NBNL1DCX','PK2NBNMP5ML','PK1OSGD','PK2NBOMXWW8','PK2NBNYG6B8','PK2NBNKPNMN','PK2NBNSVW8M','PK2NBNLA4N7','PK2NBNKJI3V','PK1PSBB','PK2NBOCNLFH','PK2NBNL79P8','PK2NBNKNT45','PK2NBNH9UDL','PK2NBNN6G2Z','PK10C2Z','PK2NBNL956S','PK2NBNH8FGL','PK1P7O6','PK1PS8O','PK2NBNLNOUD','PK1NYS9','PK10DG3','PK1O8VU','PK1P4PF','PK2NBNLBLAD','PK10A8A','PK102MG','PK107B2','PK2NBNH8MLF','PK2NBNRHEJT','PK2NBNRN807','PK2NBOE37ST','PK1NHL1','PK2NBNJT089','PK1OXVA','PK2NBNIPCFM','PK2NBNKDF3B','PK2NBNK1L7E','PK101AN','PK2NBNYOZVX','PK1RS5A','PK2NBNKVD7W','PK2NBOVCX73','PK2NBNJ30LV','PK2NBODMGG2','PK2NBNKH00G','PK2NBNZJDD1','PK2NBNJ6MZ7','PK2NBNKOH6I','PK2NBNKKMWP','PK1PZ7L','PK2NBNJY1N9','PK2NBNJ6VAU','PK2NBO5BLLV','PK2NBNL8PR9','PK2NBNS0T2R','PK2NBO4GR0O','PK108D1','PK2NBO4334K','PK2NBNLDJRG','PK2NBNLA04X','PK2NBNMP855','PK109BD','PK2NBOA0E4T','PK1PRFU','PK1PHY6','PK2NBNMMS5N','PK2NBNR79KK','PK2NBNKZWVZ','PK2NBNO3K4J','PK2NBNJ5465','PK102ON','PK2NBNKOABP','PK100VC') THEN 'EKA'
WHEN short_code IN ('PK1PDAL','PK10ACW') THEN 'SKA'
ELSE "MS"
END AS LS_ka_type_
,CASE   WHEN short_code IN ('PK2NBOC61C3','PK2NBOFSGOP','PK2NBO97C2R','PK2NBODEA4S','PK2NBNNRRHE','PK2NBNR4TPJ','PK2NBNKZV6N','PK2NBNWL6TN','PK2NBPXO1E1','PK2NBPPIMB7','PK2NBOWBI5F','PK2NBNKPTGW','PK2NBR6HN22','PK10178','PK1024X','PK106J7','PK107FJ','PK107MS','PK108M3','PK10ANN','PK10C7E','PK10G97','PK10I06','PK1NBGV','PK1NDHF','PK1O3LT','PK1O95X','PK1ORPI','PK1P4SF','PK1PHBX','PK1PK21','PK1PLRY','PK1PZ91','PK1RBUP','PK1ROIO','PK1ROVI','PK2NBNH9EKK','PK2NBNK6HNN','PK2NBNILUZ7','PK2NBNINRD0','PK2NBNIPCEP','PK2NBNJ3AH7','PK2NBNJKV5O','PK2NBNJL018','PK2NBNJXZ2K','PK2NBNJYKYV','PK2NBNJZSJ1','PK2NBNYLOTB','PK2NBNK6K30','PK2NBNK7UAX','PK2NBNK8BBN','PK2NBNKF1WH','PK2NBNKG82T','PK2NBNKMIDP','PK2NBNKMY5A','PK2NBNKRB0O','PK2NBNKRXPY','PK2NBNLBFZM','PK2NBNKVK3Z','PK2NBNKYFK0','PK2NBNKZSDH','PK2NBNL0E0E','PK2NBNL2SNV','PK2NBNL2UZR','PK2NBNL5FFX','PK2NBNL7LZC','PK2NBNL7RND','PK2NBNL95JF','PK2NBRIADN6','PK2NBNL9MEU','PK2NBNL9UOV','PK2NBNLBIK8','PK2NBNLDM4X','PK2NBNLUV3U','PK2NBNLV2RM','PK2NBNML5VY','PK2NBNMROKP','PK2NBNO1H94','PK2NBNPRPCW','PK2NBNR6XDX','PK2NBNR7NLG','PK2NBNRUZX9','PK2NBNSJ048','PK2NBNTAKT5','PK2NBNTY4ED','PK2NBNU47TJ','PK2NBNUC1LY','PK2NBNUHP2O','PK2NBNXUCE1','PK2NBNYFH9P','PK2NBNWDWS2','PK2NBNI1ZKG','PK2NBNJZMVE','PK2NBNZJ6EO','PK2NBO44J56','PK2NBO46T5N','PK2NBO4LU5V','PK2NBO4PH0E','PK2NBO5BTZO','PK2NBNYLP7C','PK2NBO5TYJ9','PK2NBR2IGLH','PK2NBO6U8CO','PK2NBO6V9C3','PK2NBO7FLZ7','PK2NBO7GLGR','PK2NBO7WDME','PK2NBO8G3X4','PK2NBO8I4Z8','PK2NBO9EMCT','PK2NBOAVCUB','PK2NBOAY2PR','PK2NBO8L30N','PK2NBOGOTAS','PK2NBOIG6CM','PK2NBORUUSX','PK2NBOWPARE','PK2NBO8X9B9','PK2NBO5YSJR','PK2NBP19A1Y','PK104JA','PK1O4PU','PK1NKIO','PK2NBNLDZKX','PK2NBNLCXX9','PK2NBO0XR69','PK2NBNMJESJ','PK2NBNJP9F0','PK1PXMO','PK2NBNO63F8','PK10JDE','PK2NBNLABXA','PK10MZ5','PK1OCKT','PK10NWP','PK2NBNMJ9ZG','PK1P5W9','PK2NBNH8UY6','PK2NBNMN9AS','PK2NBNZV856','PK2NBNL1KTD','PK2NBNIPEU1','PK1OVKN','PK10M33','PK2NBNL62CI','PK2NBNK8BBB','PK1062B','PK2NBNUNPGJ','PK2NBNHE8HU','PK106KP','PK1OB0W','PK2NBNKGVIY','PK2NBNUHSOH','PK2NBNMJ9XF','PK2NBO0FPS0','PK2NBNKKK0P','PK2NBNLC33D','PK2NBO68T0B','PK2NBNKR8F6','PK2NBNX1UVC','PK2NBNHLFPP','PK10E3S','PK2NBNMNTWR','PK2NBNMLFRK','PK2NBNWIFZE','PK10HXE','PK2NBNH69JC','PK2NBNL6S37','PK1R7YU','PK2NBO0XDYS','PK1OBIY','PK1P3ZC','PK2NBOF7RE0','PK2NBNH4VG8','PK2NBNUD5ZI','PK102B1','PK1RFCB','PK1PGSU','PK2NBNVLLFO','PK2NBNO1226','PK2NBNXKLNP','PK2NBNKYFU8','PK2NBNK9D50','PK2NBNKL061','PK1RP18','PK1PM54','PK1RFB7','PK2NBNT8C69','PK2NBNL6H4J','PK10H3Z','PK1P5CT','PK1PV8H','PK2NBNJ3P5K','PK2NBNMRH6X','PK1NNXO','PK2NBO4F48T','PK1PYA0','PK1066O','PK2NBNKERIS','PK2NBOC3IRD','PK2NBNYJTPX','PK1O847','PK2NBO4JNR1','PK2NBNKAUGM','PK2NBOE334F','PK2NBP6IM2T','PK2NBNU246V','PK2NBNUO5FN','PK2NBOHHG7E','PK1PNEC','PK2NBNI1A0U','PK2NBO4GSSE','PK2NBNH5573','PK2NBNLBIE0','PK2NBO9R8G0','PK2NBNI2RHK','PK2NBNYEUS1','PK2NBOPWJK5','PK2NBOBJA8I','PK2NBO4MWDJ','PK2NBOLPD9G','PK2NBNU3HYD','PK1PUE7','PK1PTG1','PK2NBNOEXE1','PK2NBO2A15K','PK2NBNMRRUW','PK2NBNL5AI8','PK2NBOCIMIA','PK2NBNMJCBA','PK2NBNJTJL6','PK2NBNZCYLO','PK2NBOB925T','PK2NBO09CP3','PK2NBNM9WLG','PK2NBNIWKBB','PK2NBNMRH5H') THEN 'SKA'
WHEN short_code IN ('PK1RBC5','PK107B3','PK2NBNL79PE','PK2NBOPZTUE','PK2NBNJL2H9','PK2NBNIP9XO','PK2NBNL1VNY','PK103V2','PK1NEG4','PK1P3JK','PK1NG3Z','PK103OI','PK2NBOZG7TF','PK101E4','PK101TZ','PK2NBNNYTMY','PK2NBNJSXVT','PK107B1','PK109CG','PK101Y3','PK2NBNMJ7II','PK2NBNX9YV5','PK2NBNKV0LI','PK2NBNX31OH','PK2NBNX2MD2','PK2NBNX31TB','PK2NBNK86EU','PK2NBNX2ONE','PK2NBNX2ZFR','PK1PIBM') THEN 'KA'
WHEN short_code IN ('PK105BV','PK2NBNZVI24','PK106ST','PK1R1BV','PK2NBNZVI2O') OR shop_name IN ('Sapphire','Sunaina','Maahru','Levis','Select by Daraz','Zeen By Cambridge') THEN 'SKA'
ELSE "MS"
END AS FS_ka_type
,ka_manager
,cluster
FROM    daraz_ads.ads_drz_kam_list
WHERE   ds = MAX_PT("daraz_ads.ads_drz_kam_list")
AND     venture = "PK"
) AS dd
ON      cc.join_id = dd.join_id
;
